# Changelog

## [2.0.0] - 2025-11-24

### 🎉 主要更新

#### 新增功能
- ✨ **实时密码要求显示**：弹窗打开时立即显示所有密码要求
- 🎯 **实时验证反馈**：输入密码时实时显示每个要求的满足状态
- ✓ **视觉反馈优化**：绿色对勾表示已满足，灰色圆圈表示未满足
- 🎨 **优雅的 UI 设计**：清晰的蓝色边框框架，流畅的动画过渡

#### 后台管理设置
- ⚙️ 启用强密码要求（开关）
- 📏 最小密码长度（可配置 1-100）
- 🔠 需要大写字母
- 🔡 需要小写字母
- 🔢 需要数字
- 🔣 需要特殊字符

#### 完全中文化
- 🇨🇳 所有界面文本硬编码为中文
- 📝 清晰的中文提示信息
- 🎭 更符合中文用户习惯

### 🐛 修复的问题

#### 关键修复
- 🔧 **YAML 语法错误**：修复包含特殊字符的值未加引号导致的解析错误
- 🛡️ **API 序列化错误**：添加完整的异常处理，防止序列化失败
- 🔄 **事件监听器错误**：修复为使用正确的 `__invoke()` 方法
- 🔐 **数据库迁移优化**：添加字段存在性检查和注释

#### 安全性改进
- 🛡️ 多层异常捕获，确保不影响核心功能
- 🔒 前后端双重密码验证
- 🚫 游客访问检查
- ✅ 权限验证增强

### 📚 文档更新
- 📖 添加完整的部署文档（DEPLOY.md）
- 📝 添加更新日志（UPDATE_LOG.md）
- 🎨 添加用户体验改进说明（UX_IMPROVEMENT.md）

### 🔧 技术改进

#### 代码质量
- ♻️ 符合 Flarum 最佳实践
- 🧹 移除冗余代码
- 📐 统一代码风格
- 💾 优化数据库查询

#### 性能优化
- ⚡ 使用 `boolval` 和 `intval` 简化设置序列化
- 🚀 实时验证性能优化
- 💨 流畅的 UI 更新

### 💔 破坏性变更
无破坏性变更，完全向后兼容。

### 📦 依赖更新
- Flarum Core: ^1.8.0（保持不变）

### 🙏 致谢
感谢所有用户的反馈和建议，尤其是关于用户体验的改进意见。

---

## [1.0.0] - 2025-11-23

### 初始版本
- 基础的强制密码修改功能
- 管理员创建用户时自动标记需要修改密码
- 用户首次登录时弹出修改密码弹窗
- 简单的密码验证（最小8字符）

---

## 版本说明

### 语义化版本
- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 支持的 Flarum 版本
- Flarum 1.8.0 及以上

### 安装方式
```bash
composer require jiushutech/force-password-change
```

### 升级指南
从 1.x 升级到 2.0：
1. 运行 `composer update jiushutech/force-password-change`
2. 运行 `php flarum migrate`
3. 运行 `php flarum cache:clear`
4. 在后台配置密码策略（可选）

### 问题反馈
如有问题，请访问：https://github.com/jiushutech/force-password-change/issues
